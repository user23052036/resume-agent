# Resume-Agent Backend

A Node.js/Express backend service for AI-powered resume and portfolio analysis. Supports both text and PDF resume analysis using OpenRouter LLM integration.

## Features

- **Resume Analysis**: Analyze resumes in both text and PDF formats
- **LLM Integration**: OpenRouter-powered AI analysis with fallback to local processing
- **PDF Processing**: Automatic text extraction from PDF documents
- **Role-Based Summaries**: Specialized analysis for different career roles
- **Mock Testing**: Local mock server for development and testing

## Environment Setup

Create a `.env` file at the repository root:

```bash
PORT=3000
OPENROUTER_API_KEY=your_openrouter_api_key
OPENROUTER_API_URL=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_MODEL=mistralai/mistral-7b-instruct
```

**Get a free OpenRouter API key at [https://openrouter.ai](https://openrouter.ai)** (includes free credits for testing).

## Installation & Usage

### Development

```bash
npm run dev
```

### Production

```bash
npm run build
npm start
```

## API Endpoints

### Health Check

- `GET /health` - Service health check
- Response: `{ "status": "ok" }`

### Resume Analysis

- `POST /api/resume/analyze` - Analyze resume text or PDF

**Text Analysis** (JSON):

```bash
curl -X POST http://localhost:3000/api/resume/analyze \
  -H "Content-Type: application/json" \
  -d '{"text": "John Doe. Senior Developer...", "kind": "backend-engineer"}'
```

**PDF Analysis** (Multipart):

```bash
curl -X POST http://localhost:3000/api/resume/analyze \
  -F "file=@resume.pdf" \
  -F "kind=backend-engineer"
```

**Response Format**:

```json
{
  "summary": "Professional summary generated by AI...",
  "inputLength": 1250,
  "engine": "openrouter",
  "timestamp": "2024-01-15T10:30:00.000Z",
  "pdfInfo": {
    "pageCount": 2,
    "extractedAt": "2024-01-15T10:29:58.000Z"
  }
}
```

### LLM Testing

- `POST /api/llm/test` - Test OpenRouter LLM endpoint
- Body: `{ input: string, instruction?: string, apiKey?: string, model?: string }`
- Returns: `{ result: string }`

## Dependencies

### Core Dependencies

- `express` - Web framework
- `cors` - Cross-origin resource sharing
- `dotenv` - Environment configuration
- `node-fetch` - HTTP client for LLM calls

### PDF Processing

- `pdf-parse` - PDF text extraction
- `multer` - Multipart file handling

### Development

- `tsx` - TypeScript execution
- `typescript` - TypeScript compiler

## Architecture

### Services

- **`resumeService.ts`** - Core resume analysis logic and LLM integration
- **`pdfService.ts`** - PDF text extraction and validation
- **`integrations.ts`** - External service integrations

### Controllers

- **`resumeController.ts`** - Handles resume analysis requests (text and PDF)

### Routes

- **`resume.ts`** - Resume analysis endpoints
- **`together.ts`** - LLM testing endpoints

### Adapters

- **`openrouterAdapter.ts`** - OpenRouter LLM API integration

## LLM Configuration

The backend uses a hybrid approach:

1. **Primary**: OpenRouter LLM (when `OPENROUTER_API_KEY` is set)
2. **Fallback**: Local heuristic summarizer (when no API key)

### Supported Models

- `mistralai/mistral-7b-instruct` (default, free)
- `meta-llama/llama-2-7b-chat` (free)
- `openai/gpt-3.5-turbo` (paid)
- `openai/gpt-4` (paid)

## Testing

### Local Mock Server

Run a local mock LLM server for development:

```bash
npm run mock:llm
```

This starts at `http://localhost:4000/api/v1/chat/completions`.

### Test Scripts

- `npm run test:agent` - Test resume analysis with CLI
- `simple-test.sh` - Basic endpoint testing
- `test-backend.sh` - Comprehensive backend testing

## Hackathon Integrations

The backend supports integration with hackathon sponsor tools:

- **OpenRouter**: Primary LLM provider
- **CodeRabbit**: PR review automation (optional)
- **Oumi**: Model ranking/evaluation (optional)
- **Cline**: Autonomous coding workflows (optional)
- **Kestra**: Workflow orchestration (optional)
- **Vercel**: Deployment platform

All integrations are optional and only activate when corresponding environment variables are set.

## File Structure

```bash
backend/
├── adapters/           # External service adapters
├── controllers/        # Request handlers
├── mock/              # Testing mocks
├── routes/            # API route definitions
├── services/          # Business logic
├── types.ts           # TypeScript type definitions
├── index.ts           # Main server entry point
├── cli-test.ts        # CLI testing utility
└── README.md          # This file
```

## Error Handling

The API includes comprehensive error handling:

- Invalid PDF files
- Missing required fields
- LLM service failures
- File size limits (10MB for PDFs)

## Security

- File type validation for PDF uploads
- File size limits
- Input sanitization
- CORS configuration
